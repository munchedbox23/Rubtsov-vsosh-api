{"ast":null,"code":"import _regeneratorRuntime from\"D:/OSPanel/domains/vsosh_api/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/OSPanel/domains/vsosh_api/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/OSPanel/domains/vsosh_api/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import axios from'axios';import classes from'./Discussion.module.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Discussion=function Discussion(_ref){var userId=_ref.userId,taskId=_ref.taskId,TaskName=_ref.TaskName,setDiscussionVisible=_ref.setDiscussionVisible,comments=_ref.comments,setComments=_ref.setComments;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),comment=_useState2[0],setComment=_useState2[1];var fetchComments=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"http://127.0.0.1:8000/api/v1/comments/\");case 3:response=_context.sent;setComments(response.data.filter(function(comment){return comment.task===taskId;}));_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 10:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function fetchComments(){return _ref2.apply(this,arguments);};}();useEffect(function(){fetchComments();},[taskId]);var handleAddComment=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var newComment;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(!comment){_context2.next=12;break;}_context2.prev=1;newComment={user:userId,task:taskId,content:comment};_context2.next=5;return axios.post('http://127.0.0.1:8000/api/v1/comments/create/',newComment);case 5:fetchComments();setComment('');_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);console.error(_context2.t0);case 12:case\"end\":return _context2.stop();}},_callee2,null,[[1,9]]);}));return function handleAddComment(){return _ref3.apply(this,arguments);};}();var handleDeleteComment=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(commentId){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.delete(\"http://127.0.0.1:8000/api/v1/comments/\".concat(commentId,\"/delete/\"));case 3:fetchComments();_context3.next=9;break;case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](0);console.error(_context3.t0);case 9:case\"end\":return _context3.stop();}},_callee3,null,[[0,6]]);}));return function handleDeleteComment(_x){return _ref4.apply(this,arguments);};}();var handleCloseDiscussion=function handleCloseDiscussion(){setDiscussionVisible(false);};return/*#__PURE__*/_jsxs(\"section\",{className:classes.Discussion,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.DiscussionContainer,children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleCloseDiscussion,className:classes.CloseButton,children:\"\\xD7\"}),/*#__PURE__*/_jsx(\"div\",{className:classes.DiscussionTitle,children:TaskName}),/*#__PURE__*/_jsx(\"div\",{className:classes.Discussions,children:comments.map(function(comment,index){return/*#__PURE__*/_jsxs(\"div\",{className:classes.DiscussionContent,children:[/*#__PURE__*/_jsx(\"div\",{className:classes.CommentPerson,children:comment.username}),/*#__PURE__*/_jsx(\"div\",{className:classes.Comment,children:comment.content}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleDeleteComment(comment.id);},className:classes.DeleteButton,children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})]},index);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.CommentInputContainer,children:[/*#__PURE__*/_jsx(\"textarea\",{className:classes.CommentInput,placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439\",value:comment,onChange:function onChange(e){return setComment(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{onClick:handleAddComment,className:classes.DiscussionBtn,children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439\"})]})]});};export default Discussion;","map":{"version":3,"names":["React","useState","useEffect","axios","classes","jsx","_jsx","jsxs","_jsxs","Discussion","_ref","userId","taskId","TaskName","setDiscussionVisible","comments","setComments","_useState","_useState2","_slicedToArray","comment","setComment","fetchComments","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","get","sent","data","filter","task","t0","console","error","stop","apply","arguments","handleAddComment","_ref3","_callee2","newComment","_callee2$","_context2","user","content","post","handleDeleteComment","_ref4","_callee3","commentId","_callee3$","_context3","delete","concat","_x","handleCloseDiscussion","className","children","DiscussionContainer","onClick","CloseButton","DiscussionTitle","Discussions","map","index","DiscussionContent","CommentPerson","username","Comment","id","DeleteButton","CommentInputContainer","CommentInput","placeholder","value","onChange","e","target","DiscussionBtn"],"sources":["D:/OSPanel/domains/vsosh_api/frontend/src/components/Discussion.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport classes from './Discussion.module.css';\r\n\r\nconst Discussion = ({userId, taskId, TaskName, setDiscussionVisible, comments, setComments }) => {\r\n  const [comment, setComment] = useState('');\r\n\r\n\r\n  const fetchComments = async () => {\r\n    try {\r\n      const response = await axios.get(`http://127.0.0.1:8000/api/v1/comments/`);\r\n      setComments(response.data.filter(comment => comment.task === taskId));\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchComments();\r\n  }, [taskId]);\r\n\r\n  const handleAddComment = async () => {\r\n    if (comment) {\r\n      try {\r\n        const newComment = {\r\n          user: userId,\r\n          task: taskId,\r\n          content: comment,\r\n        };\r\n\r\n        await axios.post('http://127.0.0.1:8000/api/v1/comments/create/', newComment);\r\n        fetchComments();\r\n        setComment('');\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleDeleteComment = async (commentId) => {\r\n    try {\r\n      await axios.delete(`http://127.0.0.1:8000/api/v1/comments/${commentId}/delete/`);\r\n      fetchComments();\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  const handleCloseDiscussion = () => {\r\n    setDiscussionVisible(false);\r\n  };\r\n\r\n  return (\r\n    <section className={classes.Discussion}>\r\n      <div className={classes.DiscussionContainer}>\r\n        <button onClick={handleCloseDiscussion} className={classes.CloseButton}>\r\n          &times;\r\n        </button>\r\n        <div className={classes.DiscussionTitle}>{TaskName}</div>\r\n        <div className={classes.Discussions}>\r\n          {comments.map((comment, index) => (\r\n            <div key={index} className={classes.DiscussionContent}>\r\n              <div className={classes.CommentPerson}>{comment.username}</div>\r\n              <div className={classes.Comment}>{comment.content}</div>\r\n              <button onClick={() => handleDeleteComment(comment.id)} className={classes.DeleteButton}>\r\n                Удалить\r\n              </button>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n      <div className={classes.CommentInputContainer}>\r\n        <textarea\r\n          className={classes.CommentInput}\r\n          placeholder=\"Введите комментарий\"\r\n          value={comment}\r\n          onChange={(e) => setComment(e.target.value)}\r\n        />\r\n        <button onClick={handleAddComment} className={classes.DiscussionBtn}>\r\n          Добавить комментарий\r\n        </button>\r\n      </div>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default Discussion;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}